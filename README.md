# INverse Forward Offline Reinforcement Model (INFORM)

### Codebase for : "Learning while sleeping: Integrating Sleep-Inspired Consolidation with Human Feedback Learning"

INFORM is a framework that scalably learns robust policies and reward functions from human feedback. The model consists of two phases : 
1. **A Forward model:** In this initial phase, we use a myopic interactive RL based on human feedback to train a preliminary, low-level policy.
2. **An Offline Inverse model:** Subsequently, we revisit all the trajectories generated by the previous phase and apply a non-myopic offline IRL to derive a policy and reward function that more accurately capture the task's high-level objectives.
<br>
<p align="center">
  <img src="INFORM-1.png" alt="Descriptive Alt Text" width="600" height="200"/>
</p>

# Getting started
### Prerequisites:
- Python >= 3.7.1, <3.11

Download and access to the code locally:
```bash
$ git clone https://github.com/ImeneTar/INFORM.git
$ cd INFORM
```
Install requirements:
```bash
$ pip install -r requirements/requirements.txt
$ pip install -r requirements/requirements-mujoco.txt
```

# Training an agent
To train an agent on Gridwolrd with DQN, run the following command lines:
```bash
$ python3 dqn_tamer.py
$ python3 dqn_inform.py
```
To train an agent on Pusher-v4 with SAC, run the following command lines:
```bash
$ python3 sac_tamer.py
$ python3 sac_inform.py
```
# Evaluating the robustness of the policy
To assess the robustness of the framework, we perturbed the dynamics of Pusher-V4 by addind an obstacle along the optimal way. Here are the steps to modify the environment similarly:
1. Download the source code of Gymnaisium-0.28.1 locally : [Link Text]([URL](https://github.com/Farama-Foundation/Gymnasium/releases/tag/v0.28.1)https://github.com/Farama-Foundation/Gymnasium/releases/tag/v0.28.1)

2. Modify the files:
Copy the file located at "Modified Gymnasium/pusher_v4_obstacle.py" to "Gymnaisium-0.28.1/gymnasium/envs/mujoco/"
Copy the file located at "Modified Gymnasium/assets/pusher_obstacle.xml" to "Gymnaisium-0.28.1/gymnasium/envs/mujoco/assets/"
In "Gymnaisium-0.28.1/gymnasium/envs/__init__.py", add the following lines:
```python
register(
    id="Pusher-v4-obstacle",
    entry_point="gymnasium.envs.mujoco.pusher_v4_obstacle:PusherEnv",
    max_episode_steps=100,
    reward_threshold=0.0,
)
```
3. Install the modifed Gymnasium:
```bash
$ cd Gymnasium-0.28.1/
$ pip install -e .
```

